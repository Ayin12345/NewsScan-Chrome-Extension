var content=function(){"use strict";var q=Object.defineProperty;var $=(y,c,w)=>c in y?q(y,c,{enumerable:!0,configurable:!0,writable:!0,value:w}):y[c]=w;var f=(y,c,w)=>$(y,typeof c!="symbol"?c+"":c,w);var P,R;function y(i){return i}const c={matches:["<all_urls>"],exclude_matches:["chrome://*","chrome-extension://*","moz-extension://*","edge://*","about:*","chrome-devtools://*","devtools://*","*://console.cloud.google.com/*","*://developers.google.com/*","*://apis.google.com/*","*://www.googleapis.com/*"],main(){let n=440;chrome.runtime.onMessage.addListener((o,a,r)=>{if((o==null?void 0:o.type)==="FNR_PING")return r({ok:!0}),!0}),chrome.runtime.onMessage.addListener(o=>{if((o==null?void 0:o.type)==="TOGGLE_INJECTED_SIDEBAR"){const a=!!document.getElementById("fake-news-reader-injected-sidebar");if(document.hidden&&!a)return;a?o.keepOpen?(b(),(o.preloadedAnalysis||o.hasPreloadedAnalysis)&&setTimeout(()=>{const r=document.querySelector("#fake-news-reader-injected-sidebar iframe");r!=null&&r.contentWindow&&r.contentWindow.postMessage({type:"PRELOADED_ANALYSIS",data:o.preloadedAnalysis},"*")},50)):D():(b(),o.preloadedAnalysis||o.hasPreloadedAnalysis?setTimeout(()=>{const r=document.querySelector("#fake-news-reader-injected-sidebar iframe");r!=null&&r.contentWindow&&r.contentWindow.postMessage({type:"PRELOADED_ANALYSIS",data:o.preloadedAnalysis},"*")},100):setTimeout(()=>{const r=document.querySelector("#fake-news-reader-injected-sidebar iframe");r!=null&&r.contentWindow&&r.contentWindow.postMessage({type:"TRIGGER_NEW_ANALYSIS"},"*")},50))}if((o==null?void 0:o.type)==="EXPAND_FOR_ANALYSIS"){if(document.hidden)return;const a=o.expanded;n=a?720:440,a&&!document.getElementById("fake-news-reader-injected-sidebar")?b():document.getElementById("fake-news-reader-injected-sidebar")&&A()}}),chrome.runtime.onMessage.addListener((o,a,r)=>{if(o.type==="GET_PAGE_CONTENT"){const d=()=>setTimeout(()=>s(r),300);return document.readyState!=="complete"?window.addEventListener("load",d,{once:!0}):d(),!0}});function s(o){try{let a=null;a=document.querySelector("article"),a||(a=document.querySelector('main, [role="main" ]')),a||(a=document.querySelector(".article, .story, .post, .entry, .content-body")),a||(a=document.body);const r=a.cloneNode(!0);r.querySelectorAll('script, style, noscript, iframe, nav, header, footer, aside, .ads, [role="complementary"]').forEach(u=>u.remove());let p=Array.from(r.querySelectorAll("p")).map(u=>{var m;return((m=u.textContent)==null?void 0:m.trim())||""}).filter(Boolean).join(" ");p.length<200&&(p=(r.innerText||"").trim()),p=p.replace(/\s+/g," ").trim();const S=p.split(/\s+/).filter(Boolean).length;o({success:!0,data:{title:document.title,content:p,url:location.href,wordCount:S}})}catch{try{o({error:"Failed to extract page content."})}catch{}}}let t=null;const l=window.matchMedia("(prefers-reduced-motion: reduce)"),g=l.matches?0:160;function b(o){document.hidden&&!t||(t||W(),t.style.opacity="1",A())}function W(){if(t||document.getElementById("fake-news-reader-injected-sidebar"))return;t=document.createElement("div"),t.id="fake-news-reader-injected-sidebar",t.setAttribute("aria-label","Fake News Reader Sidebar"),t.style.position="fixed",t.style.top="0",t.style.right="0",t.style.height="100vh",t.style.zIndex="2147483647",t.style.background="#fff",t.style.borderLeft="1px solid rgba(0,0,0,0.12)",t.style.boxShadow="0 0 0 1px rgba(0,0,0,0.06), -2px 0 8px rgba(0,0,0,0.06)",t.style.overflow="hidden",t.style.transition=`width ${g}ms ease, opacity ${g}ms ease`,t.style.display="block";const o=document.createElement("div");o.style.height="100%",o.style.display="flex",o.style.flexDirection="column";const a=document.createElement("div");a.style.cssText=["all: initial","display: flex","align-items: center","justify-content: space-between","padding: 12px 16px","border-bottom: 1px solid rgba(0,0,0,0.12)","box-sizing: border-box","width: 100%","background: #ffffff","box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08)"].join(";");const r=document.createElement("div");r.style.cssText=["all: initial","display: flex","align-items: center","gap: 8px"].join(";");const d=document.createElement("img"),p=chrome.runtime.getURL("logo.png");d.src=p,d.alt="NewsScan Logo",d.style.cssText=["all: initial","width: 35px","height: 35px","object-fit: contain"].join(";"),d.onerror=L=>{d.style.display="none"};const S=document.createElement("span");S.textContent="NewsScan",S.style.cssText=["all: initial","font: 600 15px system-ui, -apple-system, Segoe UI, Roboto","color: #202124","letter-spacing: -0.01em"].join(";"),r.appendChild(d),r.appendChild(S);const u=document.createElement("button");u.setAttribute("aria-label","Close"),u.textContent="Ã—",u.style.cssText=["all: initial","display:inline-flex","align-items:center","justify-content:center","width:28px","height:28px","cursor:pointer","font: 600 16px/1 system-ui, -apple-system, Segoe UI, Roboto","color:#6b7280","background:transparent","border-radius: 4px"].join(";"),a.appendChild(r),a.appendChild(u);const m=document.createElement("div");m.style.flex="1",m.style.overflow="hidden";const h=document.createElement("iframe");h.title="NewsScan",h.style.border="0",h.style.width="100%",h.style.height="100%",h.src=chrome.runtime.getURL("sidepanel.html"),m.appendChild(h),u.onclick=()=>{var L;try{(L=h.contentWindow)==null||L.postMessage({type:"TRIGGER_RESET"},"*")}catch{}setTimeout(()=>{D()},50)},o.appendChild(a),o.appendChild(m),t.appendChild(o),document.documentElement.appendChild(t),A()}function D(){t&&(t.remove(),t=null,j())}function U(){document.documentElement.style.scrollBehavior="auto",document.body.style.transition=l.matches?"":`margin-right ${g}ms ease`,document.body.style.marginRight=`${n}px`}function j(){document.body.style.marginRight="",document.body.style.transition=""}function A(){t&&(t.style.width=`${n}px`,t.style.opacity="1",U())}document.addEventListener("visibilitychange",()=>{document.hidden&&t?(t.style.opacity="0",j()):!document.hidden&&t&&(t.style.opacity="1",A())})}},v=(R=(P=globalThis.browser)==null?void 0:P.runtime)!=null&&R.id?globalThis.browser:globalThis.chrome;function x(i,...e){}const k={debug:(...i)=>x(console.debug,...i),log:(...i)=>x(console.log,...i),warn:(...i)=>x(console.warn,...i),error:(...i)=>x(console.error,...i)},T=class T extends Event{constructor(e,n){super(T.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=n}};f(T,"EVENT_NAME",_("wxt:locationchange"));let N=T;function _(i){var e;return`${(e=v==null?void 0:v.runtime)==null?void 0:e.id}:content:${i}`}function F(i){let e,n;return{run(){e==null&&(n=new URL(location.href),e=i.setInterval(()=>{let s=new URL(location.href);s.href!==n.href&&(window.dispatchEvent(new N(s,n)),n=s)},1e3))}}}const E=class E{constructor(e,n){f(this,"isTopFrame",window.self===window.top);f(this,"abortController");f(this,"locationWatcher",F(this));f(this,"receivedMessageIds",new Set);this.contentScriptName=e,this.options=n,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(e){return this.abortController.abort(e)}get isInvalid(){return v.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,n){const s=setInterval(()=>{this.isValid&&e()},n);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(e,n){const s=setTimeout(()=>{this.isValid&&e()},n);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(e){const n=requestAnimationFrame((...s)=>{this.isValid&&e(...s)});return this.onInvalidated(()=>cancelAnimationFrame(n)),n}requestIdleCallback(e,n){const s=requestIdleCallback((...t)=>{this.signal.aborted||e(...t)},n);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(e,n,s,t){var l;n==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(l=e.addEventListener)==null||l.call(e,n.startsWith("wxt:")?_(n):n,s,{...t,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),k.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:E.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(e){var l,g,b;const n=((l=e.data)==null?void 0:l.type)===E.SCRIPT_STARTED_MESSAGE_TYPE,s=((g=e.data)==null?void 0:g.contentScriptName)===this.contentScriptName,t=!this.receivedMessageIds.has((b=e.data)==null?void 0:b.messageId);return n&&s&&t}listenForNewerScripts(e){let n=!0;const s=t=>{if(this.verifyScriptStartedEvent(t)){this.receivedMessageIds.add(t.data.messageId);const l=n;if(n=!1,l&&(e!=null&&e.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))}};f(E,"SCRIPT_STARTED_MESSAGE_TYPE",_("wxt:content-script-started"));let C=E;function G(){}function I(i,...e){}const M={debug:(...i)=>I(console.debug,...i),log:(...i)=>I(console.log,...i),warn:(...i)=>I(console.warn,...i),error:(...i)=>I(console.error,...i)};return(async()=>{try{const{main:i,...e}=c,n=new C("content",e);return await i(n)}catch(i){throw M.error('The content script "content" crashed on startup!',i),i}})()}();
content;
