var background=function(){"use strict";var c,u;async function l(e,n){var a;const t=await(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"user",content:e}]})})).json();if(t.choices&&t.choices[0]&&t.choices[0].message.content)return t.choices[0].message.content;throw new Error(((a=t.error)==null?void 0:a.message)||"No response from OpenAI")}async function f(e,n){var a;const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}],generationConfig:{temperature:.7,maxOutputTokens:1e3}})});if(!r.ok){const o=await r.text();throw new Error(`Gemini API error: ${r.status} ${r.statusText} - ${o}`)}const t=await r.json();if(t.candidates&&t.candidates[0]&&t.candidates[0].content&&t.candidates[0].content.parts&&t.candidates[0].content.parts[0])return t.candidates[0].content.parts[0].text;throw new Error(((a=t.error)==null?void 0:a.message)||"No response from Gemini")}async function d(e,n){var a;const r=await fetch("https://api-inference.huggingface.co/models/meta-llama/Llama-3.3-70B-Instruct",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:e,parameters:{max_new_tokens:500,temperature:.7,return_full_text:!1}})});if(!r.ok){const o=await r.text();throw new Error(`Llama API error: ${r.status} ${r.statusText} - ${o}`)}const t=await r.json();if(Array.isArray(t)&&((a=t[0])!=null&&a.generated_text))return t[0].generated_text;throw new Error(t.error||"No valid response from Llama")}async function h(e,n){const r=await fetch("https://api.cohere.ai/v1/generate",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({model:"command",prompt:e,max_tokens:1250})});if(!r.ok)throw new Error(`Cohere API error: ${r.status} ${r.statusText}`);const t=await r.json();if(t.generations&&t.generations[0]&&t.generations[0].text)return t.generations[0].text;throw new Error(t.message||"No response from Cohere")}async function p(e,n){var a;const r=await fetch("https://api-inference.huggingface.co/models/mistralai/Mistral-7B-Instruct-v0.3",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:e,parameters:{max_new_tokens:500,temperature:.7,return_full_text:!1}})});if(!r.ok){const o=await r.text();throw new Error(`Mistral API error: ${r.status} ${r.statusText} - ${o}`)}const t=await r.json();if(Array.isArray(t)&&((a=t[0])!=null&&a.generated_text))return t[0].generated_text;throw new Error(t.error||"No valid response from Mistral 7B")}async function m(e,n){const r=await fetch("https://api-inference.huggingface.co/models/mistralai/Mixtral-8x7B-Instruct-v0.1",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:e,parameters:{max_new_tokens:500,temperature:.7,return_full_text:!1}})});if(!r.ok){const a=await r.text();throw new Error(`Mixtral API error: ${r.status} ${r.statusText} - ${a}`)}const t=await r.json();if(Array.isArray(t)&&t[0]&&t[0].generated_text)return t[0].generated_text;throw new Error(t.error||"No response from Mixtral 8x7B")}function w(e){return e==null||typeof e=="function"?{main:e}:e}const g=w({main(){chrome.runtime.onInstalled.addListener(()=>{console.log("Extension installed")}),chrome.runtime.onMessage.addListener((e,n,r)=>(e.type==="GET_PAGE_INFO"?(async()=>{try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!(t!=null&&t.id)){r({success:!1,error:"No active tab found"});return}const a=await chrome.tabs.sendMessage(t.id,{type:"GET_PAGE_CONTENT"});if(a&&a.error){r({success:!1,error:a.error});return}a.success&&a.data?r({success:!0,data:a.data}):r({success:!1,error:"Invalid page info format"})}catch{r({success:!1,error:"Failed to fetch page info"})}})():e.type==="ANALYZE_ARTICLE"&&(async()=>{try{const t=e.providers||[],a=await Promise.allSettled(t.map(async o=>{switch(o){case"OpenAI":return await l(e.content,"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");case"Gemini":return await f(e.content,"AIzaSyA82I5_GdxU23af9sklb3mLb8T-tuPP1BE");case"Cohere":return await h(e.content,"d4rtWmY3HK9su8mrSbxlsrWEJod7TZyGeNH3ZvdG");case"Mistral7B":return await p(e.content,"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");case"Mixtral8x7B":return await m(e.content,"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");case"Llama":return await d(e.content,"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");default:throw new Error(`Unknown provider: ${o}`)}}));r({success:!0,data:a,providers:t})}catch{r({success:!1,error:"Failed to analyze article"})}})(),!0))}});function x(){}(u=(c=globalThis.browser)==null?void 0:c.runtime)!=null&&u.id?globalThis.browser:globalThis.chrome;function s(e,...n){}const y={debug:(...e)=>s(console.debug,...e),log:(...e)=>s(console.log,...e),warn:(...e)=>s(console.warn,...e),error:(...e)=>s(console.error,...e)};let i;try{i=g.main(),i instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(e){throw y.error("The background crashed on startup!"),e}return i}();
background;
